<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
  <head>
    
    <!-- Relative Navigation -->
    
    <link rel="up" href="Collections" />
    <link rel="prev" href="Element_Types" />
    <link rel="next" href="Sealing" />
    
    <!-- Absolute Navigation -->
    
    <link rel="top" href="Title" />
    <link rel="start first" href="." />
    <link rel="copyright" href="Copyrights" />
    <link rel="contents" href="Contents" />
    <link rel="glossary" href="Glossary" />
    <link rel="index" href="Index" />
    <link rel="last author" href="Colophon" />
    
    <!-- Chapters -->
    
    <link rel="chapter" title="About This Book" href="Preface" />
    <link rel="chapter" title="1 Introduction" href="Introduction" />
    <link rel="chapter" title="2 Syntax" href="Syntax" />
    <link rel="chapter" title="3 Program Structure" href="Program_Structure" />
    <link rel="chapter" title="4 Program Control" href="Program_Control" />
    <link rel="chapter" title="5 Types and Classes" href="Types_and_Classes" />
    <link rel="chapter" title="6 Functions" href="Functions" />
    <link rel="chapter" title="7 Conditions" href="Conditions" />
    <link rel="chapter" title="8 Collections" href="Collections" />
    <link rel="chapter" title="9 Sealing" href="Sealing" />
    <link rel="chapter" title="10 Macros" href="Macros" />
    <link rel="chapter" title="11 The Built-In Classes" href="Built-In_Classes" />
    <link rel="chapter" title="12 The Built-In Functions" href="Built-In_Functions" />
    <link rel="chapter" title="13 Other Built-In Objects" href="Other_Built-In_Objects" />
    <link rel="chapter" title="14 The Built-In Macros and Special Definitions" href="Built-In_Macros_and_Special_Definitions" />
    
    <!-- Appendices -->
    
    <link rel="appendix" title="A BNF" href="BNF" />
    <link rel="appendix" title="B Exported Names" href="Exported_Names" />
    
    <!-- Stylesheets -->
    
    <link rel="stylesheet" href="styles/common.css" type="text/css" />
    <link rel="stylesheet" href="styles/nav-top-fixed.css" type="text/css" media="handheld" />
    <link rel="stylesheet" href="styles/nav-left-fixed.css" type="text/css" media="screen" title="Navigation at Left" />
    <link rel="stylesheet alternate" href="styles/nav-top-fixed.css" type="text/css" media="screen" title="Navigation at Top" />

    <title>Limited Collection Types &mdash; 8. Collections &mdash; The DRM</title>
  </head>
  <body class="content">

    <div id="header">
      <div id="navigation-header">
	<div id="navigation-top">
	  <div class="background">
	    <p id="book-title">
	    <img class="book-icon" alt="" src="images/color-square-small.png" width="22" height="21" />
	    <a href="Title"><img class="book-title" alt="The Dylan Reference Manual" src="images/book-title.png" width="343" height="28" /></a>
	  </p>
	  <p id="navigation-core">
	    <a class="previous" accesskey="p" title="Previous Page" href="Element_Types"><span>&larr; Previous</span></a>
	    <a class="next" accesskey="n" title="Next Page" href="Sealing"><span>Next Page &rarr;</span></a>
	    <a class="up" accesskey="u" title="Chapter Start" href="Collections"><span>Up</span></a>
	    <a class="start" accesskey="s" title="Start of Book" href="Title"><span>Start</span></a>
	    <a class="contents" accesskey="c" title="Contents" href="Contents"><span>Contents</span></a>
	    <a class="index" accesskey="i" title="Index" href="Index"><span>Index</span></a>
	  </p>
	</div>
	</div>
	<div id="navigation-TOC">
	  <ul class="front-matter">
	    <li id="book-start"><a href="Title">Start</a></li>
	    <li><a href="Contents">Contents</a></li>
	    <li><a href="Preface">About This Book</a></li>
	  </ul>
	  <ol class="chapters">
	    <li><a href="Introduction">Introduction</a></li>
	    <li><a href="Syntax">Syntax</a></li>
	    <li><a href="Program_Structure">Program Structure</a></li>
	    <li><a href="Program_Control">Program Control</a></li>
	    <li><a href="Types_and_Classes">Types and Classes</a></li>
	    <li><a href="Functions">Functions</a></li>
	    <li><a href="Conditions">Conditions</a></li>
	    <li class="current parent"><a href="Collections">Collections</a>
	      <ul class="sections">
		<li><a href="Collections_Overview">Overview</a></li>
		<li><a href="Collection_Keys">Collection Keys</a></li>
		<li><a href="Iteration_Stability_and_Natural_Order">Iteration Stability and Natural Order</a></li>
		<li><a href="Mutability">Mutability</a></li>
		<li><a href="Collection_Alteration_and_Allocation">Collection Alteration and Allocation</a></li>
		<li><a href="Collection_Alignment">Collection Alignment</a></li>
		<li><a href="Defining_a_New_Collection_Class">Defining a New Collection Class</a></li>
		<li><a href="Tables">Tables</a></li>
		<li><a href="Element_Types">Element Types</a></li>
		<li id="current" class="subsections"><a href="Limited_Collection_Types">Limited Collection Types</a>
		  <ul class="page-TOC">
		    <li><a href="#HEADING-69-36">Creating Limited Collection Types</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a href="Sealing">Sealing</a></li>
	    <li><a href="Macros">Macros</a></li>
	    <li><a href="Built-In_Classes">The Built-In Classes</a></li>
	    <li><a href="Built-In_Functions">The Built-In Functions</a></li>
	    <li><a href="Other_Built-In_Objects">Other Built-In Objects</a></li>
	    <li><a href="Built-In_Macros_and_Special_Definitions">The Built-In Macros and Special Definitions</a></li>
	  </ol>
	  <ol class="appendices">
	    <li><a href="BNF">BNF</a></li>
	    <li><a href="Exported_Names">Exported Names</a></li>
	  </ol>
	  <ul class="back-matter">
	    <li><a href="Glossary">Glossary</a></li>
	    <li><a href="Index">Index</a></li>
	    <li><a href="Colophon">Colophon</a></li>
	  </ul>
	  <ul class="errata">
	    <li><a href="Errata">Errata</a></li>
	  </ul>
	</div>
      </div>

      <hr />

    </div>

    <div id="content">
      <div id="section-header">
	<p id="section-prefix">Chapter 8</p>
	<p id="section-name">Collections</p>
      </div>

      <a name="HEADING-69-0"></a>
      <a name="UID-Collections-3802"></a>
      <h1 class="section-title"><a name="XREF-1060"></a><a name="IX-1061">Limited Collection Types</a></h1>
      <p>Limited collections are subtypes of <code>&lt;collection&gt;</code> that are constrained to
	have a particular size or dimensions and that are constrained to hold elements of a
	particular type.</p>
      <p>If <var>C</var> is a subclass of <code>&lt;collection&gt;</code> whose element type is
	indefinite <code>&lArr;</code> <var>T<em><sub>1</sub></em></var>, then it is possible to
	create any number of limited collection types that can be described
	as <code>limited(<var>C</var>, of: <var>T<em><sub>2</sub></em></var>,
	  size: <var>S</var>)</code>.</p>
      <p>Like a collection class, a limited collection type has a conceptual element type. The
	element type of <code>limited(<var>C</var>, of: <var>T<em><sub>2</sub></em></var>,
	  size: <var>S</var>)</code>
	is <var>T<em><sub>2</sub></em></var>. <var>T<em><sub>2</sub></em></var> must be an instance
	of <code>&lt;type&gt;</code> and a subtype
	of <var>T<em><sub>1</sub></em></var>. <var>C</var> is the base class of the new limited
	collection type.</p>
      <p><var>S</var> limits the size of instances of a limited collection type. <var>S</var> can
	be <code>#f</code>, which means no limitation, or a non-negative integer, which means that
	every instance of the limited collection type has exactly that many elements.</p>
      <p><var>S</var> must be <code>#f</code> if <var>C</var> is stretchy
	(e.g. <code>&lt;table&gt;</code>, <code>&lt;stretchy-vector&gt;</code>,
	or <code>&lt;deque&gt;</code>).</p>
      <p>If <var>C</var> is <code>&lt;array&gt;</code> then it is also possible to create any number
	of limited collection types, which can be described as <code>limited(&lt;array&gt;,
	  of: <var>T</var>, dimensions: <var>D</var>)</code>. <var>D</var> must be a sequence of
	non-negative integers; the rank of each instance is <code>size(<var>D)</var></code> and the
	dimensions of each instance are the elements of <var>D</var>. You cannot specify
	both <code>size:</code> and <code>dimensions:</code> in the same type.</p>
      <p>Some limited collection types are
	instantiable. <code>make(limited(<var>C</var>, <var>&hellip;</var>), <var>&hellip;</var>)</code>
	returns a direct instance of some subclass of <var>C</var>. Typically this class is not
	standardized and its name is not exported, but it is valid for this class to be <var>C</var>
	itself. There is nothing special about this class; it is simply a class known to the
	applicable <code>limited</code> method and its creation is subject to all the usual sealing
	restrictions.</p>
      <p>An object <var>X</var> is an <a name="IX-1062">instance of a limited collection
	type</a> <code>limited(<var>C</var>, of: <var>T<em><sub>2</sub></em></var>,
	size: <var>S</var>)</code> if and only if all of the following are true:</p>
      <ul>
	<li><code>object-class(<var>X</var>)</code> is a subclass of <var>C</var>.</li>
	<li><var>X</var>'s size matches <var>S</var>, as described above.</li>
	<li>If <var>X</var> is an instance of <code>&lt;stretchy-collection&gt;</code>
	  then <var>S</var> must be <code>#f</code>.</li>
	<li>The element type of <var>X</var> is equivalent
	  to <var>T<em><sub>2</sub></em></var>.</li>
      </ul>
      <p>An object <var>X</var> is an instance of a type <code>limited(<var>C</var>,
	  of: <var>T<em><sub>2</sub></em></var>, dimensions: <var>D</var>)</code> if and only if all
	of the following are true:</p>
      <ul>
	<li><code>object-class(<var>X</var>)</code> is a subclass of <var>C</var>.</li>
	<li><code>dimensions(<var>X</var>)</code> <code>=</code> <var>D</var>.</li>
	<li><var>X</var> is not an instance of <code>&lt;stretchy-collection&gt;</code>.</li>
	<li>The element type of <var>X</var> is equivalent
	  to <var>T<em><sub>2</sub></em></var>.<a name="IX-1063"></a></li>
      </ul>
      <p>Each element of an instance of a limited collection type must be an instance of the element
	type. Fetching an element of the collection is guaranteed to return an instance of the
	element type. Setting or initializing an element will check that the new element is an
	instance of the element type and signal an error of type <code>&lt;type-error&gt;</code> if
	it is not.</p>
      <p>If <var>L<em><sub>1</sub></em></var> is a <a name="IX-1064">subtype
	of <var>L<em><sub>2</sub></em></var> and <var>L<em><sub>2</sub></em></var> is a limited
	collection type</a>, then <var>L<em><sub>1</sub></em></var> is either a singleton of an
	instance of <var>L<em><sub>2</sub></em></var> or a limited collection type that satisfies
	one of the following sets of rules:</p>
      <ol>
	<li>If neither <var>L<em><sub>1</sub></em></var> nor <var>L<em><sub>2</sub></em></var>
	  specifies a <code>dimensions:</code> attribute, let <var>L<em><sub>1</sub></em></var>
	  be <code>limited(<var>C<em><sub>1</sub></em></var>, of: <var>T<em><sub>1</sub></em></var>,
	    size: <var>S<em><sub>1</sub></em></var>)</code>, and <var>L<em><sub>2</sub></em></var>
	  be <code>limited(<var>C<em><sub>2</sub></em></var>, of: <var>T<em><sub>2</sub></em></var>,
	    size: <var>S<em><sub>2</sub></em></var>)</code>. All of the following must be true:
	  <ul>
	    <li><var>C<em><sub>1</sub></em></var> is a subclass
	      of <var>C<em><sub>2</sub></em></var>.</li>
	    <li>If <var>S<em><sub>2</sub></em></var> is not
	      #<code>f</code>, <var>S<em><sub>1</sub></em></var>
	      = <var>S<em><sub>2</sub></em></var>.</li>
	    <li><var>T<em><sub>1</sub></em></var> and <var>T<em><sub>2</sub></em></var> are
	      equivalent types.</li>
	  </ul>
	</li>
	<li>If either <var>L<em><sub>1</sub></em></var> or <var>L<em><sub>2</sub></em></var>,
	  specifies a <code>dimensions:</code> attribute, then all of the following must be
	  true. Let <var>L<em><sub>1</sub></em></var>
	  be <code>limited(<var>C<em><sub>1</sub></em></var>, of: <var>T<em><sub>1</sub></em></var>,
	    dimensions: <var>D<em><sub>1</sub></em></var>)</code>,
	  and <var>L<em><sub>2</sub></em></var> be
	  either <code>limited(<var>C<em><sub>2</sub></em></var>,
	    of: <var>T<em><sub>2</sub></em></var>,
	    dimensions: <var>D<em><sub>2</sub></em></var>)</code>
	  or <code>limited(<var>C<em><sub>2</sub></em></var>, of: <var>T<em><sub>2</sub></em></var>,
	    size: <var>S<em><sub>2</sub></em></var>)</code>.
	  <ul>
	    <li><var>C<em><sub>1</sub></em></var> is a subclass
	      of <var>C<em><sub>2</sub></em></var>.</li>
	    <li><var>D<em><sub>1</sub></em></var> is present (i.e. <var>L<em><sub>1</sub></em></var>
	      must specify a dimensions attribute).</li>
	    <li>If <var>D<em><sub>2</sub></em></var> is
	      present, <var>D<em><sub>1</sub></em></var> <code>=</code> <var>D<em><sub>2</sub></em></var>.</li>
	    <li>If <var>S<em><sub>2</sub></em></var> is
	      not <code>#f</code>, <code>reduce1(\*, <var>D<em><sub>1</sub></em></var>)
		= <var>S<em><sub>2</sub></em></var></code>.</li>
	    <li><var>T<em><sub>1</sub></em></var> and <var>T<em><sub>2</sub></em></var> are
	      equivalent types.</li>
	  </ul>
	</li>
      </ol>
      <p>The limited collection type <code>limited(<var>C</var>, of: <var>T</var>,
	  size: <var>S</var>)</code> is a subtype of <var>C</var>. The limited collection
	type <code>limited(<var>C</var>, of: <var>T</var>, dimensions: <var>D</var>)</code> is a
	subtype of <var>C</var>.<a name="IX-1065"></a></p>
      <a name="HEADING-69-31"></a>
      <h3 class="sub-subsection-title"><a name="IX-1066">Element Type Subclassing</a></h3>
      <p>The element type subclassing rules are generalized to limited collection types as follows
	(this is implied by the preceding and is included here for explanatory purposes only):</p>
      <p>If the element type of a limited collection type <var>L<em><sub>1</sub></em></var>
	is <var>T<em><sub>1</sub></em></var>, each instance of <var>L<em><sub>1</sub></em></var>
	stores elements of type <var>T<em><sub>1</sub></em></var>. The <code>element</code> method
	will always return an instance of <var>T<em><sub>1</sub></em></var> and
	the <code>element-setter</code> method will accept any instance
	of <var>T<em><sub>1</sub></em></var>. Each limited collection type that is a subtype
	of <var>L<em><sub>1</sub></em></var> must have an element
	type <var>T<em><sub>2</sub></em></var> that is equivalent
	to <var>T<em><sub>1</sub></em></var>.</p>
      <p>If the element type of a class <var>C<em><sub>1</sub></em></var> is
	indefinite <code>&lArr;</code> <var>T<em><sub>1</sub></em></var>, each limited collection
	type that is a subtype of <var>C<em><sub>1</sub></em></var> has an element
	type <var>T<em><sub>2</sub></em></var> and <var>T<em><sub>2</sub></em></var> must be a
	subtype of <var>T<em><sub>1</sub></em></var>. Thus <code>element</code> on any instance
	of <var>C<em><sub>1</sub></em></var> will return an instance
	of <var>T<em><sub>1</sub></em></var> (and will not return all possible instances
	of <var>T<em><sub>1</sub></em></var> if <var>T<em><sub>2</sub></em></var> is a proper
	subtype of <var>T<em><sub>1</sub></em></var>), and it is not determined
	by <var>C<em><sub>1</sub></em></var> what the applicable <code>element-setter</code> method
	will accept (hence the term <q>indefinite</q>).</p>
      <p>The above statements about the value returned by <code>element</code> only apply when
	no <code>default:</code> keyword argument is specified.<a name="IX-1067"></a></p>
      <a name="HEADING-69-36"></a>
      <a name="UID-Collections-3838"></a>
      <h2 class="subsection-title"><a name="IX-1068">Creating Limited Collection Types</a></h2>
      <p>You obtain a type object for a limited collection type by calling the <code>limited</code>
	generic function on a collection class. There are several built-in methods
	for <code>limited</code> specialized for specific subclasses
	of <code>&lt;collection&gt;</code>. Each of these methods accepts a required keyword
	argument <code>of:</code> and also accepts an optional keyword argument <code>size:</code>
	if the class is not stretchy. If the class is <code>&lt;array&gt;</code> the optional
	keyword argument <code>dimensions:</code> is also accepted. Each method returns a type. The
	returned type is never a class. If the <code>size:</code> keyword argument is accepted but
	not supplied, it defaults to <code>#f</code>.</p>
      <p>Users cannot write portable methods for <code>limited</code>. There are no built-in methods
	for <code>limited</code> applicable to user-defined classes.</p>
      <a name="HEADING-69-39"></a>
      <h3 class="sub-subsection-title"><a name="IX-1069">Uninstantiable Limited Collection Types</a></h3>
      <p>Methods on <code>limited</code> support the creation of uninstantiable limited types for
	the following classes:</p>
      <ul>
	<li><code>&lt;collection&gt;</code></li>
	<li><code>&lt;explicit-key-collection&gt;</code></li>
	<li><code>&lt;mutable-collection&gt;</code></li>
	<li><code>&lt;stretchy-collection&gt;</code></li>
	<li><code>&lt;mutable-explicit-key-collection&gt;</code></li>
	<li><code>&lt;sequence&gt;</code></li>
	<li><code>&lt;mutable-sequence&gt;</code></li>
      </ul>
      <p>Although limited types created from these classes cannot be instantiated, they are still
	useful as specializers.<a name="IX-1070"></a></p>
      <a name="HEADING-69-49"></a>
      <h3 class="sub-subsection-title"><a name="IX-1071">Instantiable Limited Collection Types</a></h3>
      <p>Methods on <code>limited</code> support the creation of instantiable limited types for the
	following classes:</p>
      <ul>
	<li><code>&lt;table&gt;</code></li>
	<li><code>&lt;object-table&gt;</code></li>
	<li><code>&lt;array&gt;</code></li>
	<li><code>&lt;vector&gt;</code></li>
	<li><code>&lt;simple-vector&gt;</code></li>
	<li><code>&lt;stretchy-vector&gt;</code></li>
	<li><code>&lt;deque&gt;</code></li>
	<li><code>&lt;string&gt;</code></li>
	<li><code>&lt;range&gt;</code></li>
      </ul>
      <p>These methods are described in
	<a href="Built-In_Functions">Chapter 12, <q>The Built-In Functions,</q></a>
	on <a href="Constructing_and_Initializing_Instances#XREF-1559">page 263</a>.
	<a name="IX-1072"></a><a name="IX-1073"></a><a name="IX-1074"></a></p>
      <p class="errata-note" id="errata-p129-1">
	<a class="note-tag" href="Errata#p129-1"><strong>Errata:</strong></a> In the published book,
	<code>&lt;deque&gt;</code> is missing from the list of instantiable limited collection
	types. There is a method specialized on <code>&lt;deque&gt;</code> in the list of methods
	for <a href="Constructing_and_Initializing_Instances#limited"><code>limited</code></a>, the
	discussion of which indicates that it is instantiable.
      </p>
      <a name="LINK-Collections-lastpage"></a><a name="LINK-SealingTOC-firstpage"></a>
      <a name="UID-SealingTOC-411"></a>
      <a name="LINK-SealingTOC-lastpage"></a>
    </div>

    <div id="footer">

      <hr />
      <address>The Dylan Reference Manual - 7 Apr 1998</address>
      <p id="navigation-footer">
	<a class="previous" accesskey="p" title="Previous Page" href="Element_Types"><span>&larr; Previous</span></a>
	<a class="next" accesskey="n" title="Next Page" href="Sealing"><span>Next Page &rarr;</span></a>
	<a class="up" accesskey="u" title="Chapter Start" href="Collections"><span>Up</span></a>
	<a class="start" accesskey="s" title="Start of Book" href="Title"><span>Start</span></a>
	<a class="contents" accesskey="c" title="Contents" href="Contents"><span>Contents</span></a>
	<a class="index" accesskey="i" title="Index" href="Index"><span>Index</span></a>
      </p>
      <p>Copyright Apple Computer, Inc. 1996. Apple&reg; and the Apple logo are registered
	trademarks of Apple Computer, Inc. Used with permission. All Rights Reserved.</p>
      <p>Originally generated with Harlequin WebMaker&reg;, subsequently revised.</p>
    </div>
  </body>
</html>
