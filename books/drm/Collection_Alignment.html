<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
  <head>
    
    <!-- Relative Navigation -->
    
    <link rel="up" href="Collections" />
    <link rel="prev" href="Collection_Alteration_and_Allocation" />
    <link rel="next" href="Defining_a_New_Collection_Class" />
    
    <!-- Absolute Navigation -->
    
    <link rel="top" href="Title" />
    <link rel="start first" href="." />
    <link rel="copyright" href="Copyrights" />
    <link rel="contents" href="Contents" />
    <link rel="glossary" href="Glossary" />
    <link rel="index" href="Index" />
    <link rel="last author" href="Colophon" />
    
    <!-- Chapters -->
    
    <link rel="chapter" title="About This Book" href="Preface" />
    <link rel="chapter" title="1 Introduction" href="Introduction" />
    <link rel="chapter" title="2 Syntax" href="Syntax" />
    <link rel="chapter" title="3 Program Structure" href="Program_Structure" />
    <link rel="chapter" title="4 Program Control" href="Program_Control" />
    <link rel="chapter" title="5 Types and Classes" href="Types_and_Classes" />
    <link rel="chapter" title="6 Functions" href="Functions" />
    <link rel="chapter" title="7 Conditions" href="Conditions" />
    <link rel="chapter" title="8 Collections" href="Collections" />
    <link rel="chapter" title="9 Sealing" href="Sealing" />
    <link rel="chapter" title="10 Macros" href="Macros" />
    <link rel="chapter" title="11 The Built-In Classes" href="Built-In_Classes" />
    <link rel="chapter" title="12 The Built-In Functions" href="Built-In_Functions" />
    <link rel="chapter" title="13 Other Built-In Objects" href="Other_Built-In_Objects" />
    <link rel="chapter" title="14 The Built-In Macros and Special Definitions" href="Built-In_Macros_and_Special_Definitions" />
    
    <!-- Appendices -->
    
    <link rel="appendix" title="A BNF" href="BNF" />
    <link rel="appendix" title="B Exported Names" href="Exported_Names" />
    
    <!-- Stylesheets -->
    
    <link rel="stylesheet" href="styles/common.css" type="text/css" />
    <link rel="stylesheet" href="styles/nav-top-fixed.css" type="text/css" media="handheld" />
    <link rel="stylesheet" href="styles/nav-left-fixed.css" type="text/css" media="screen" title="Navigation at Left" />
    <link rel="stylesheet alternate" href="styles/nav-top-fixed.css" type="text/css" media="screen" title="Navigation at Top" />

    <title>Collection Alignment &mdash; 8. Collections &mdash; The DRM</title>
  </head>
  <body class="content">

    <div id="header">
      <div id="navigation-header">
	<div id="navigation-top">
	  <div class="background">
	    <p id="book-title">
	    <img class="book-icon" alt="" src="images/color-square-small.png" width="22" height="21" />
	    <a href="Title"><img class="book-title" alt="The Dylan Reference Manual" src="images/book-title.png" width="343" height="28" /></a>
	  </p>
	  <p id="navigation-core">
	    <a class="previous" accesskey="p" title="Previous Page" href="Collection_Alteration_and_Allocation"><span>&larr; Previous</span></a>
	    <a class="next" accesskey="n" title="Next Page" href="Defining_a_New_Collection_Class"><span>Next Page &rarr;</span></a>
	    <a class="up" accesskey="u" title="Chapter Start" href="Collections"><span>Up</span></a>
	    <a class="start" accesskey="s" title="Start of Book" href="Title"><span>Start</span></a>
	    <a class="contents" accesskey="c" title="Contents" href="Contents"><span>Contents</span></a>
	    <a class="index" accesskey="i" title="Index" href="Index"><span>Index</span></a>
	  </p>
	</div>
	</div>
	<div id="navigation-TOC">
	  <ul class="front-matter">
	    <li id="book-start"><a href="Title">Start</a></li>
	    <li><a href="Contents">Contents</a></li>
	    <li><a href="Preface">About This Book</a></li>
	  </ul>
	  <ol class="chapters">
	    <li><a href="Introduction">Introduction</a></li>
	    <li><a href="Syntax">Syntax</a></li>
	    <li><a href="Program_Structure">Program Structure</a></li>
	    <li><a href="Program_Control">Program Control</a></li>
	    <li><a href="Types_and_Classes">Types and Classes</a></li>
	    <li><a href="Functions">Functions</a></li>
	    <li><a href="Conditions">Conditions</a></li>
	    <li class="current parent"><a href="Collections">Collections</a>
	      <ul class="sections">
		<li><a href="Collections_Overview">Overview</a></li>
		<li><a href="Collection_Keys">Collection Keys</a></li>
		<li><a href="Iteration_Stability_and_Natural_Order">Iteration Stability and Natural Order</a></li>
		<li><a href="Mutability">Mutability</a></li>
		<li><a href="Collection_Alteration_and_Allocation">Collection Alteration and Allocation</a></li>
		<li id="current"><a href="Collection_Alignment">Collection Alignment</a></li>
		<li><a href="Defining_a_New_Collection_Class">Defining a New Collection Class</a></li>
		<li><a href="Tables">Tables</a></li>
		<li><a href="Element_Types">Element Types</a></li>
		<li><a href="Limited_Collection_Types">Limited Collection Types</a></li>
	      </ul>
	    </li>
	    <li><a href="Sealing">Sealing</a></li>
	    <li><a href="Macros">Macros</a></li>
	    <li><a href="Built-In_Classes">The Built-In Classes</a></li>
	    <li><a href="Built-In_Functions">The Built-In Functions</a></li>
	    <li><a href="Other_Built-In_Objects">Other Built-In Objects</a></li>
	    <li><a href="Built-In_Macros_and_Special_Definitions">The Built-In Macros and Special Definitions</a></li>
	  </ol>
	  <ol class="appendices">
	    <li><a href="BNF">BNF</a></li>
	    <li><a href="Exported_Names">Exported Names</a></li>
	  </ol>
	  <ul class="back-matter">
	    <li><a href="Glossary">Glossary</a></li>
	    <li><a href="Index">Index</a></li>
	    <li><a href="Colophon">Colophon</a></li>
	  </ul>
	  <ul class="errata">
	    <li><a href="Errata">Errata</a></li>
	  </ul>
	</div>
      </div>

      <hr />

    </div>

    <div id="content">
      <div id="section-header">
	<p id="section-prefix">Chapter 8</p>
	<p id="section-name">Collections</p>
      </div>

      <a name="HEADING-65-0"></a>
      <a name="UID-Collections-2808"></a>
      <h1 class="section-title"><a name="XREF-1021"></a><a name="IX-1022">Collection Alignment</a></h1>
      <p>Some operations on collections are defined to allow the use of more than a single
	collection. For example, some looping functions accept any number of collections and operate
	on these collections in parallel. Each pass through the loop uses one element from each
	collection. The presence of collections that are unstable under iteration can create
	problems for multi-collection operations unless special care is taken. If iteration is
	effectively performed in random order, then naively performing parallel iterations over two
	different collections would randomly combine values from the two collections. This would
	presumably have no meaning.</p>
      <p>To prevent such random combinations, operations on more than one collection must in general
	align the collections. <dfn>Collection alignment</dfn> consists of effectively computing the
	intersection of the collections' key sequences and then using the random-access operations
	(<code>element</code> and <code>element-setter</code>) to operate on the collections
	themselves.</p>
      <p>If implemented naively, this definition of alignment has the potential for extreme
	inefficiency because of its dependence on <code>element</code> and the potential loops implied
	by the calls to <code>key-sequence</code>. However, an important special case of this problem
	is that of iterating over multiple sequences. In this case, the intersection of key sequences
	will always be the non-negative integers up to the length of the shortest sequence. Further,
	unlike collections in general, sequences are required to exhibit stability so the explicit
	computation of key sequences is not actually required. It is correct simply to iterate until
	one or more of the sequences is exhausted.</p>
      <p>Iteration operations that store results in a target collection must generally include the
	target collection during alignment. This alignment requirement is relaxed if the target
	collection is a <code id="IX-1023">&lt;stretchy-collection&gt;</code>. In this case, the
	target collection is not considered during alignment. Rather, only the source collections are
	aligned. New keys may be added to the target collection during the course of the iteration,
	and keys may be given new values. Other keys are left undisturbed.</p>
      <p><a name="IX-1024">It is only possible to align collections that have identical
	key tests.</a><a name="IX-1025"></a></p>

    </div>

    <div id="footer">

      <hr />
      <address>The Dylan Reference Manual - 7 Apr 1998</address>
      <p id="navigation-footer">
	<a class="previous" accesskey="p" title="Previous Page" href="Collection_Alteration_and_Allocation"><span>&larr; Previous</span></a>
	<a class="next" accesskey="n" title="Next Page" href="Defining_a_New_Collection_Class"><span>Next Page &rarr;</span></a>
	<a class="up" accesskey="u" title="Chapter Start" href="Collections"><span>Up</span></a>
	<a class="start" accesskey="s" title="Start of Book" href="Title"><span>Start</span></a>
	<a class="contents" accesskey="c" title="Contents" href="Contents"><span>Contents</span></a>
	<a class="index" accesskey="i" title="Index" href="Index"><span>Index</span></a>
      </p>
      <p>Copyright Apple Computer, Inc. 1996. Apple&reg; and the Apple logo are registered
	trademarks of Apple Computer, Inc. Used with permission. All Rights Reserved.</p>
      <p>Originally generated with Harlequin WebMaker&reg;, subsequently revised.</p>
    </div>
  </body>
</html>
